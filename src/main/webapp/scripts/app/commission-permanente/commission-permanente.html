<div>
    <!-- Content Header (Page header) -->
    <section class="content-header">
        <h1>
            La commission permanente
        </h1>
    </section>

    <!-- Main content -->
    <section class="content">
        <div class="container">
            <h2 ng-if="!comm.appartenances.length && !comm.fonctions.length && !comm.fonctionsExecutives.length">
                Aucun membre à la commission permanente
            </h2>
            <div ng-if="comm.appartenances.length || comm.fonctions.length || comm.fonctionsExecutives.length">
                <div class="row">
                    <div class="col-md-12 align-right">
                        <a class="btn btn-sm btn-primary" href="api/commission-permanente/export">
                            <span class="fa fa-table"></span>
                            <span>Export Excel</span>
                        </a>
                    </div>
                </div>
            </div>
            <div ng-if="comm.fonctionsExecutives.length">
                <h2 class="commission-permanente-titre">Les élus ayant une fonction exécutive</h2>
                <div class="row" ng-init="fonctionsExecutivesChunks = _.chunk((comm.fonctionsExecutives | filter:{dateFin: '!'}), 3)">
                    <div class="col-md-12 col-sm-12 col-xs-12" ng-repeat="fonctionsExecutives in fonctionsExecutivesChunks">
                        <div class="col-md-4 col-sm-6 col-xs-12" ng-repeat="f in fonctionsExecutives">
                            <div class="info-box entity-component" ng-init="elu = comm.elus[f.elu.id]"
                                 ui-sref="elu.detail({id:elu.id})">
                                <span class="info-box-photo">
                                    <img ng-if="elu.image" ng-src="images/{{elu.image}}"/>
                                </span>

                                <div class="info-box-content">
                                <span
                                    class="info-box-titre">{{elu.civilite | civilite}} {{elu.prenom}} {{elu.nom}}</span>
                                    <span class="info-box-info fonction">{{f.fonction}}</span>
                                    <div class="info-box-info">
                                        Depuis le {{f.dateDebut}}
                                        <div ng-if="a.dateFin">Prend fin le {{f.dateFin}} pour le motif suivant :
                                            {{f.motifFin}}
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <hr class="commission-permanente-separator"/>
            <div ng-if="comm.appartenances.length">
                <h2 class="commission-permanente-titre">Les membres de la commission</h2>
                <div class="row" ng-init="appartenancesChunks = _.chunk((comm.appartenances | filter:{dateFin: '!'}), 3)">
                    <div class="col-md-12 col-sm-12 col-xs-12"
                         ng-repeat="appartenances in appartenancesChunks">
                        <div class="col-md-4 col-sm-6 col-xs-12" ng-repeat="a in appartenances">
                            <div class="info-box entity-component" ng-init="elu = comm.elus[a.elu.id]"
                                 ui-sref="elu.detail({id:elu.id})">
                                <span class="info-box-photo">
                                    <img ng-if="elu.image" ng-src="images/{{elu.image}}"/>
                                </span>

                                <div class="info-box-content">
                                    <span
                                        class="info-box-titre">{{elu.civilite | civilite}} {{elu.prenom}} {{elu.nom}}</span>
                                    <div class="info-box-info">
                                        Depuis le {{a.dateDebut}}
                                        <div ng-if="a.dateFin">Prend fin le {{a.dateFin}} pour le motif suivant :
                                            {{a.motifFin}}
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <hr class="commission-permanente-separator"/>
            <div ng-if="comm.fonctions.length">
                <h2 class="commission-permanente-titre">Les élus ayant une fonction à la commission</h2>
                <div class="row" ng-init="fonctionsChunks = _.chunk((comm.fonctions | filter:{dateFin: '!'}), 3)">
                    <div class="col-md-12 col-sm-12 col-xs-12" ng-repeat="fonctions in fonctionsChunks">
                        <div class="col-md-4 col-sm-6 col-xs-12" ng-repeat="f in fonctions">
                            <div class="info-box entity-component" ng-init="elu = comm.elus[f.elu.id]"
                                 ui-sref="elu.detail({id:elu.id})">
                                <span class="info-box-photo">
                                    <img ng-if="elu.image" ng-src="images/{{elu.image}}"/>
                                </span>

                                <div class="info-box-content">
                                    <span
                                        class="info-box-titre">{{elu.civilite | civilite}} {{elu.prenom}} {{elu.nom}}</span>
                                        <span class="info-box-info fonction">{{f.fonction}}</span>
                                    <div class="info-box-info">
                                        Depuis le {{f.dateDebut}}
                                        <div ng-if="a.dateFin">Prend fin le {{f.dateFin}} pour le motif suivant :
                                            {{f.motifFin}}
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-12">
                <div class="box box-default box-solid collapsed-box">
                    <div class="box-header with-border">
                        <h3 class="box-title">Anciens membres</h3>

                        <div class="box-tools pull-right">
                            <button type="button" class="btn btn-box-tool" data-widget="collapse"><i
                                class="fa fa-plus"></i>
                            </button>
                        </div>
                    </div>
                    <div class="box-body" style="display: none;">
                        <h2>Les élus ayant eu une fonction exécutive</h2>

                        <div class="row" ng-init="fonctionsExecutivesPasseesChunks = _.chunk((comm.fonctionsExecutives | filter:{dateFin: ''}), 3)">
                            <div class="col-md-12 col-sm-12 col-xs-12" ng-repeat="fonctionsExecutives in fonctionsExecutivesPasseesChunks">
                                <div class="col-md-4 col-sm-6 col-xs-12" ng-repeat="f in fonctionsExecutives">
                                    <div class="info-box entity-component" ng-init="elu = comm.elus[f.elu.id]"
                                         ui-sref="elu.detail({id:elu.id})">
                                        <span class="info-box-photo">
                                            <img ng-if="elu.image" ng-src="images/{{elu.image}}"/>
                                        </span>

                                        <div class="info-box-content">
                                            <span
                                                class="info-box-titre">{{elu.civilite | civilite}} {{elu.prenom}} {{elu.nom}}</span>
                                            <span class="info-box-info fonction">{{f.fonction}}</span>
                                            <div class="info-box-info">
                                                Depuis le {{f.dateDebut}}
                                                <div ng-if="f.dateFin">Prend fin le {{f.dateFin}} pour le motif suivant :
                                                    {{f.motifFin}}
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <h2>Les anciens membres de la commission</h2>
                        <div class="row" ng-init="appartenancesPasseesChunks = _.chunk((comm.appartenances | filter:{dateFin: ''}), 3)">
                            <div class="col-md-12 col-sm-12 col-xs-12"
                                 ng-repeat="appartenances in appartenancesPasseesChunks">
                                <div class="col-md-4 col-sm-6 col-xs-12" ng-repeat="a in appartenances">
                                    <div class="info-box entity-component" ng-init="elu = comm.elus[a.elu.id]"
                                         ui-sref="elu.detail({id:elu.id})">
                                <span class="info-box-photo">
                                    <img ng-if="elu.image" ng-src="images/{{elu.image}}"/>
                                </span>

                                        <div class="info-box-content">
                                    <span
                                        class="info-box-titre">{{elu.civilite | civilite}} {{elu.prenom}} {{elu.nom}}</span>
                                            <div class="info-box-info">
                                                Depuis le {{a.dateDebut}}
                                                <div ng-if="a.dateFin">Prend fin le {{a.dateFin}} pour le motif suivant :
                                                    {{a.motifFin}}
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <h2>Les élus ayant eu une fonction à la commission</h2>
                        <div class="row" ng-init="fonctionsPasseesChunks = _.chunk((comm.fonctions | filter:{dateFin: ''}), 3)">
                            <div class="col-md-12 col-sm-12 col-xs-12" ng-repeat="fonctions in fonctionsPasseesChunks">
                                <div class="col-md-4 col-sm-6 col-xs-12" ng-repeat="f in fonctions">
                                    <div class="info-box entity-component" ng-init="elu = comm.elus[f.elu.id]"
                                         ui-sref="elu.detail({id:elu.id})">
                                <span class="info-box-photo">
                                    <img ng-if="elu.image" ng-src="images/{{elu.image}}"/>
                                </span>

                                        <div class="info-box-content">
                                <span
                                    class="info-box-titre">{{elu.civilite | civilite}} {{elu.prenom}} {{elu.nom}}</span>
                                            <span class="info-box-info fonction">{{f.fonction}}</span>
                                            <div class="info-box-info">
                                                Depuis le {{f.dateDebut}}
                                                <div ng-if="f.dateFin">Prend fin le {{f.dateFin}} pour le motif suivant :
                                                    {{f.motifFin}}
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
</div>
